---
export const prerender = true;

import "../styles/global/global.css";
import "../styles/global/reset.css";
import "../styles/global/theme.css";

import { ToastContainer } from "react-toastify";
import { BasicAccordion } from "~/components/Accordion";
import { FeaturedPhotos } from "~/components/FeaturedPhotos";
import { Form } from "~/components/Form";
import { Hero } from "~/components/Hero";

import { ResponsiveHeadline } from "~/components/ResponsiveHeadline";
import { RichText } from "~/components/RichText";
import Layout from "~/layouts/Layout.astro";
import { contentfulClient } from "~/services/contentful/contentful";
import { anchorTarget, section } from "~/styles/utilities/common.css";
import type { TypePageSectionSkeleton } from "~/types/contentful";
import type { TypeList, TypeListSkeleton } from "~/types/contentful/TypeList";
import type { TypeSeoSkeleton } from "../types/contentful/TypeSeo";

const anchorSection = `${section} ${anchorTarget}`;

const seoEntry = await contentfulClient.getEntries<TypeSeoSkeleton>({
	content_type: "seo",
	"fields.internalTitle": "Home",
});
const seo = seoEntry.items[0]?.fields;

const entryIntro = await contentfulClient.getEntries<TypePageSectionSkeleton>({
	content_type: "pageSection",
	"fields.title": "Home Section",
});

const entryContact = await contentfulClient.getEntries<TypePageSectionSkeleton>({
	content_type: "pageSection",
	"fields.title": "Contact Us Section",
});

const faqs = await contentfulClient.getEntries<TypeListSkeleton>({
	content_type: "list",
	"fields.title": "FAQs",
});
---

<Layout seo={seo}>
  <ToastContainer position="top-center" client:idle />
  <Hero />
  <section id="intro" class={anchorSection}> 
    {
      entryIntro.items.map((item) => (
        <div>
          {item.fields.content && (
            <RichText richText={item.fields.content} client:visible />
          )}
        </div>
      ))
    }
  </section>
  <section id="faqs" class={anchorSection}> 
    <ResponsiveHeadline size={2} as="h2">
      Frequently Asked Questions
    </ResponsiveHeadline>
    <BasicAccordion
      list={faqs.items[0] as TypeList<"WITHOUT_UNRESOLVABLE_LINKS">}
      client:visible
    />
  </section>
  <section id="contact" class={anchorSection}> 
    {
      entryContact.items.map((item) => (
        <div>
          {item.fields.content && (
            <RichText richText={item.fields.content} client:visible />
          )}
        </div>
      ))
    }
    <Form client:idle />
  </section>
  <section id="featured" class={anchorSection}> 
    <ResponsiveHeadline size={2} as="h2"> Chaos in Action </ResponsiveHeadline>
    <FeaturedPhotos galleryName="Featured Photos" maxPhotos={12}  />
  </section>
</Layout>
