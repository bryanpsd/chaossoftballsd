---
import { ResponsiveHeadline } from "~/components/ResponsiveHeadline";
import Layout from "~/layouts/Layout.astro";
import { contentfulClient } from "~/services/contentful/contentful";
import type { TypePageSkeleton } from "~/types/contentful";
import { RichText } from "../components/RichText";
import * as styles from "../styles/utilities/common.css";

const { slug = "" } = Astro.params;

const entry = await contentfulClient.getEntries<TypePageSkeleton>({
    content_type: "page",
    "fields.slug": slug,
    limit: 1,
});

if (!slug || !entry.items || entry.items.length === 0) {
    Astro.response.status = 404;
    throw new Error("Not Found");
}

const pageContent = entry.items[0]?.fields || {};
---

<Layout
    title={`${pageContent.seoTitle} | Chaos Softball San Diego`}
    description={pageContent.seoDescription}
>
    <div class={styles.subPageWrapper}>
        <ResponsiveHeadline size={3} as="h1">
            {pageContent.title}
        </ResponsiveHeadline>
        {pageContent.content && <RichText richText={pageContent.content} />}
    </div>
</Layout>
